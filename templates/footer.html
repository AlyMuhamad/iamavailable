<footer class="footer">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-4">
        <div class="footer-brand">IAmAvailable</div>
        <p class="footer-text">
          The best job board for developers and all technical specialists all
          over the world
        </p>
        <div class="social-links">
          <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
          <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
          <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
          <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
        </div>
      </div>

      <div class="col-md-4 text-md-end">
        <ul class="footer-links">
          <li><a href=" {% url 'about' %}">About</a></li>
          <li><a href="{% url 'contact' %}">Contact</a></li>
          <li><a href="{% url 'terms' %}">Terms</a></li>
          <li><a href="{% url 'faq' %}">FAQ</a></li>
        </ul>
      </div>

      <form class="col-md-4">
        {% csrf_token %}
        <p class="footer-brand">Subscribe</p>
        <p class="footer-text">Subscribe to our newsletter and stay updated</p>
        <div class="position-relative">
          <input
            class="p-2 border-0 rounded w-100 email"
            placeholder="Enter your email"
          />
          <button
            class="border-0 p-2 rounded text-white bg-dark position-absolute end-0 top-50 translate-middle-y subBtn"
          >
            Subscribe
          </button>
        </div>
      </form>
    </div>

    <div class="copyright text-center">
      Â© 2025 IAmAvailable. All rights reserved.
    </div>
  </div>
</footer>
<script>
  const subBtn = document.querySelector('.subBtn');
  const email = document.querySelector('.email');
  subBtn.addEventListener('click', e => {
    e.preventDefault();
    if (!email.value) {
      email.placeholder = 'Please enter a valid email';
      return;
    } else {
      subscribe();
    }
  });

  async function subscribe() {
    const requestOptions = {
      method: 'POST',
      headers: {
        'X-CSRFToken': getCookie('csrftoken'),
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        email: email.value,
      }),
    };

    try {
      const res = await fetch(`/subscribe/`, requestOptions);
      if (res.status == 400) {
        email.value = '';
        email.placeholder = 'Invalid email, Please enter a valid email';
      }
      if (res.status == 409) {
        email.value = '';
        email.placeholder =
          'This email was used before, Please enter a valid email';
      }
      if (res.status == 200) {
        email.value = '';
        email.placeholder = 'Your email was subscried to our newsletter';
      }
    } catch (err) {
      console.log(err);
    }
  }

  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === name + '=') {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
        }
        break;
      }
    }
    return cookieValue;
  }
</script>
